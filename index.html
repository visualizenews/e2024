<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5,user-scalable=1">
    <link href="./css/screen.css" rel="stylesheet">
    <title>Elections Year</title>
  </head>
  <body>
    <header id="header">
      <h1 class="show-calendar">Elections Year</h1>
    </header>
    <section id="intro">
      <header>
        <h2>2024 is Elections Year!</h2>
        <h3>Yes, with more than 2,500 different countried going to the polls for several different elections, either local, national, or sovra-national 2024 is already special.</h3>
        <h3>Here is a quick recap of all the appointments and their results. Feel free to scroll down to browse chronologically, or <em class="show-calendar">jump to the election you want ğŸ—³ï¸</em>.</h3>
      </header>
    </section>
    
    <section id="charts"></section>
    <footer></footer>



    <section id="calendar">
      <div class="container"></div>
    </section>

    <script>
      const isValidDate = (year, month, day) => {
          var d = new Date(year, month, day);
          if (d.getFullYear() == year && d.getMonth() == month && d.getDate() == day) {
              return true;
          }
          return false;
      };

      const countryWrapper = (day, month) => {
        let html = '';
        console.log(`2024-${month + 1}-${day}`, new Date(`2024-${month + 1}-${day}`), isNaN(new Date(`2024-${month + 1}-${day}`)));
        console.log('-', new Date(2024, month, day));
        if (!isValidDate(2024, month, day)) {
          html = '<div class="day day-no" />';
        } else {
          const today = countries.filter(d => d.day === day && d.month === month + 1);
          if (today.length) {
            html = `<div class="day day-${today.length}">${today.map(c => (`<div class="country country-button" data-target="${c.month}-${c.day}-${c.country}" title="${c.country}">${c.flag}</div>`)).join('')}</div>`;
          } else {
            html = '<div class="day day-empty" />';
          }
        }
        return html;
      };

      const tableHeaders = () => {
        let html = '<th />';
        months.forEach((m) => {
          html += `<th>${m}</th>`;
        });
        return html;
      };

      const tableBody = () => {
        let html = "";
        for (let i = 1; i <= 31; i += 1) {
          html += `
          <tr>
            <th>${i}</th>
            ${
              months.map((m, j) => {
                return `<td>${countryWrapper(i, j)}</td>`;
              }).join('')
            }
          </tr>`;
        }
        return html;
      }

      const countries = [
        {
          month: 1,
          day: 24,
          flag: 'ğŸ‡¹ğŸ‡»',
          country: 'Tuvalu',
        },
        {
          month: 2,
          day: 2,
          flag: 'ğŸ‡¹ğŸ‡¼',
          country: 'Taiwan',
        },
        {
          month: 2,
          day: 3,
          flag: 'ğŸ‡¸ğŸ‡³',
          country: 'Senegal',
        },
        {
          month: 2,
          day: 3,
          flag: 'ğŸ‡ªğŸ‡¬',
          country: 'Egypt',
        },
        {
          month: 12,
          day: 3,
          flag: 'ğŸ‡®ğŸ‡¹',
          country: 'Italy',
        },
        {
          month: 12,
          day: 3,
          flag: 'ğŸ‡«ğŸ‡·',
          country: 'France',
        },
        {
          month: 12,
          day: 3,
          flag: 'ğŸ‡µğŸ‡«',
          country: 'French Polinesia',
        }
      ];
      const months = [
        'J<span class="long">an</span>',
        'F<span class="long">eb</span>',
        'M<span class="long">ar</span>',
        'A<span class="long">pr</span>',
        'M<span class="long">ay</span>',
        'J<span class="long">un</span>',
        'J<span class="long">ul</span>',
        'A<span class="long">ug</span>',
        'S<span class="long">ep</span>',
        'O<span class="long">ct</span>',
        'N<span class="long">ov</span>',
        'D<span class="long">ec</span>'
      ];      
      const calendar = document.querySelector('#calendar');
      
      calendar.querySelector('.container').innerHTML = `
      <table>
        <thead>
          <tr>
            ${tableHeaders()}
          </tr>
        <thead>
        <tbody>
          ${tableBody()}
        </tbody>
      </table>`;

      const anchors = document.querySelectorAll('.country-button');
      anchors.forEach((a) => {
        a.addEventListener(
        'click', (e) => {
          e.preventDefault();
          const target = e.target.getAttribute('data-target');
          // calendar.style.display = 'none';
          document.location.hash = target;
        });
      });

      const showCalendarSwitches = document.querySelectorAll('.show-calendar');
      showCalendarSwitches.forEach((s) => {
        s.addEventListener('click', (e) => {
          e.preventDefault();
          // calendar.style.display = 'flex';
        })
      });

    </script>
  </body>
</html>